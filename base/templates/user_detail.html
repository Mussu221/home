{% extends 'layout1.html' %}
{% block content %}

<style>
    .wa-star-bar-rating,
    .wa-star-bar-rating i {
        display: block;
        height: 25px;
    }

    .wa-star-bar-rating {
        width: 125px;
        -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 150 150" height="150px" width="150px"><g transform="translate(-25,0)"><path d="m 172.35714,67.190469 -36.77859,35.505441 8.39818,50.4259 -45.132893,-24.00674 -45.362705,23.5696 8.884939,-50.34242 L 25.932197,66.483167 76.55628,59.376583 99.401613,13.644842 121.80408,59.595151 Z" /></g></svg>') repeat-x;
        mask: url('data:image/svg+xml;utf8,<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 150 150" height="150px" width="150px"><g transform="translate(-25,0)"><path d="m 172.35714,67.190469 -36.77859,35.505441 8.39818,50.4259 -45.132893,-24.00674 -45.362705,23.5696 8.884939,-50.34242 L 25.932197,66.483167 76.55628,59.376583 99.401613,13.644842 121.80408,59.595151 Z" /></g></svg>') repeat-x;
        -webkit-mask-size: 25px 25px;
        mask-size: 25px 25px;
        background-color: #aaa;
    }

    .wa-star-bar-rating i {
        background-color: #fe9100;
    }
</style>

<div class="row">
    <div class="col-xxl-4">
        <div class="card">
            <div class="card-body p-4">
                <div>
                    <div class="flex-shrink-0 avatar-md mx-auto">
                        <div class="avatar-title bg-light rounded">
                            <img src="{{url_for('static',filename='profile_pic/'+user.image_name)}}" alt=""
                                height="50" />
                        </div>
                    </div>
                    <div class="mt-4 text-center">
                        <h5 class="mb-1">{{user.fullname}}</h5>
                    </div>
                    <div class="table-responsive">
                        <table class="table mb-0 table-borderless">
                            <tbody>

                                <tr>
                                    <th><span class="fw-medium">Email</span></th>
                                    <td>{{user.email}}</td>
                                </tr>
                                <tr>
                                    <th><span class="fw-medium">Contact No.</span></th>
                                    <td>{{user.phone_no}}</td>
                                </tr>
                                <tr>
                                    <th><span class="fw-medium">Host Languages</span></th>
                                    <td>{{user.host_language}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <!--end card-body-->
            <div class="card-body border-top border-top-dashed p-4">
                <div>
                    <h6 class="text-muted text-uppercase fw-semibold mb-4">Overall Reviews</h6>
                    <div>
                        <div>
                            <div class="bg-light px-3 py-2 rounded-2 mb-2">
                                <div class="d-flex align-items-center">
                                    <div class="flex-grow-1">
                                        <div class="fs-16 align-middle text-warning">
                                            <div class="wa-star-bar-rating"><i style="width:{{rating_average}}%"></i>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="flex-shrink-0">
                                        <h6 class="mb-0">{{average_review}} out of 5</h6>
                                    </div>
                                </div>
                            </div>
                            <div class="text-center">
                                <div class="text-muted">Total <span class="fw-medium">{{total_review_count}}</span>
                                    reviews</div>
                            </div>
                        </div>

                        <div class="mt-3">
                            <div class="row align-items-center g-2">
                                <div class="col-auto">
                                    <div class="p-1">
                                        <h6 class="mb-0">5 star</h6>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="p-1">
                                        <div class="progress animated-progress progress-sm">
                                            <div class="progress-bar bg-success" role="progressbar"
                                                style="width: {{average[5]}}%" aria-valuenow="{{average[5]}}"
                                                aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-auto">
                                    <div class="p-1">
                                        <h6 class="mb-0 text-muted">{{ratings[5]}}</h6>
                                    </div>
                                </div>
                            </div>
                            <!-- end row -->

                            <div class="row align-items-center g-2">
                                <div class="col-auto">
                                    <div class="p-1">
                                        <h6 class="mb-0">4 star</h6>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="p-1">
                                        <div class="progress animated-progress progress-sm">
                                            <div class="progress-bar bg-success" role="progressbar"
                                                style="width: {{average[4]}}%" aria-valuenow="{{average[4]}}"
                                                aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-auto">
                                    <div class="p-1">
                                        <h6 class="mb-0 text-muted">{{ratings[4]}}</h6>
                                    </div>
                                </div>
                            </div>
                            <!-- end row -->

                            <div class="row align-items-center g-2">
                                <div class="col-auto">
                                    <div class="p-1">
                                        <h6 class="mb-0">3 star</h6>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="p-1">
                                        <div class="progress animated-progress progress-sm">
                                            <div class="progress-bar bg-success" role="progressbar"
                                                style="width: {{average[3]}}%" aria-valuenow="{{average[3]}}"
                                                aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-auto">
                                    <div class="p-1">
                                        <h6 class="mb-0 text-muted">{{ratings[3]}}</h6>
                                    </div>
                                </div>
                            </div>
                            <!-- end row -->

                            <div class="row align-items-center g-2">
                                <div class="col-auto">
                                    <div class="p-1">
                                        <h6 class="mb-0">2 star</h6>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="p-1">
                                        <div class="progress animated-progress progress-sm">
                                            <div class="progress-bar bg-warning" role="progressbar"
                                                style="width: {{average[2]}}%" aria-valuenow="{{average[2]}}"
                                                aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-auto">
                                    <div class="p-1">
                                        <h6 class="mb-0 text-muted">{{ratings[2]}}</h6>
                                    </div>
                                </div>
                            </div>
                            <!-- end row -->

                            <div class="row align-items-center g-2">
                                <div class="col-auto">
                                    <div class="p-1">
                                        <h6 class="mb-0">1 star</h6>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="p-1">
                                        <div class="progress animated-progress progress-sm">
                                            <div class="progress-bar bg-danger" role="progressbar"
                                                style="width: {{average[1]}}%" aria-valuenow="{{average[1]}}"
                                                aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-auto">
                                    <div class="p-1">
                                        <h6 class="mb-0 text-muted">{{ratings[1]}}</h6>
                                    </div>
                                </div>
                            </div><!-- end row -->
                        </div>
                    </div>
                </div>
            </div>
            <!--end card-body-->

            <div class="card-body p-4 border-top border-top-dashed">
                <h6 class="text-muted text-uppercase fw-semibold mb-4">Contact Support</h6>
                <form action="#">
                    <div class="mb-3">
                        <textarea class="form-control" id="exampleFormControlTextarea1" rows="4"
                            placeholder="Enter your messages..."></textarea>
                    </div>
                    <div class="text-end">
                        <button type="submit" class="btn btn-dark"><i
                                class="ri-mail-send-line align-bottom me-1"></i> Send Messages</button>
                    </div>
                </form>
            </div>
            <!--end card-body-->
        </div>
        <!--end card-->
    </div>
    <!--end col-->

    <div class="col-xxl-8">
        <div class="row">
            <div class="col-xxl-12">
                <div class="card">
                    <div class="card-header align-items-center d-flex">
                        <h4 class="card-title mb-0 flex-grow-1">
                            Recent properties
                        </h4>
                    </div>
                    <!-- end card header -->

                    <div class="card-body">
                        <div class="table-responsive table-card">
                            <table class="table table-hover table-centered align-middle table-nowrap mb-0">
                                <thead>
                                    <th>#SR NO</th>
                                    <th>
                                        Property
                                    </th>
                                    <th>Price Per Night</th>
                                    <th>Bookings</th>
                                    <th>Create Date</th>

                                </thead>
                                <tbody>
                                    {%if property_length ==0 %}
                                <tr class="mt-5 mb-5">

                                    <td colspan="5">
                                        <div class="noresult" class="mt-5 mb-5">
                                            <div class="text-center">
                                                <lord-icon src="https://cdn.lordicon.com/kjiurikz.json" trigger="loop"
                                                    style="width:100px;height:100px">
                                                </lord-icon>
                                                <h5 class="mt-2">No Property !</h5>
                                            </div>
                                        </div>
                                    </td>
                                </tr>

                                {% else %}

                                    {% for property in properties %}


                                    <tr>
                                        <td width="120px">{{ loop.index }}
                                        </td>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <div class="avatar-sm bg-light rounded p-1 me-2">
                                                    <a class="image-popup"
                                                        href="{{url_for('static',filename='property_images/'+property.images[0].picture_name)}}"
                                                        title="">

                                                        <img style="max-height: 40px;"
                                                            src="{{url_for('static',filename='property_images/'+property.images[0].picture_name)}}"
                                                            alt="" class="avatar-sm rounded object-cover" />
                                                    </a>
                                                </div>
                                                <h5 class="fs-14 my-1">
                                                    <a href="{{url_for('admin_view.property_detail',property_id=property.id)}}"
                                                        class="text-reset">{{property.title}}</a>
                                                </h5>
                                            </div>
                                        </td>

                        </div>
                        </td>
                        <td>
                            <h5 class="fs-14 my-1 fw-normal">$ {{property.price_per_night}}</h5>
                        </td>
                        <td>
                            <h5 class="fs-14 my-1 fw-normal">{{len(property.bookings)}}</h5>
                        </td>
                        <td>
                            <h5 class="fs-14 my-1 fw-normal">{{property.created_at.strftime("%b %d, %Y")}}</h5>
                        </td>
                        </tr>

                        {% endfor %}

                        <tr><td colspan="5" class="text-end"><a href=""  class="btn btn-dark">View all</a></td>   </tr>
{% endif %}


                        </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-xxl-12">
            <div class="card">
                <div class="card-header align-items-center d-flex">
                    <h4 class="card-title mb-0 flex-grow-1">
                        Recent Bookings
                    </h4>
                </div>
                <!-- end card header -->

                <div class="card-body">
                    <div class="table-responsive table-card">
                        <table class="table table-hover table-centered align-middle table-nowrap mb-0">
                            <thead>
                                <th>#SR NO</th>
                                <th>
                                    Property
                                </th>
                                <th>Price Per Night</th>
                                <th>Booking Dates</th>
                                <th>Status</th>


                            </thead>
                            <tbody>
                                {%if booking_length ==0 %}
                                <tr class="mt-5 mb-5">

                                    <td colspan="5">
                                        <div class="noresult" class="mt-5 mb-5">
                                            <div class="text-center">
                                                <lord-icon src="https://cdn.lordicon.com/kjiurikz.json" trigger="loop"
                                                    style="width:100px;height:100px">
                                                </lord-icon>
                                                <h5 class="mt-2">No bookings yet !</h5>
                                            </div>
                                        </div>
                                    </td>
                                </tr>


                                {% else %}

                                {% for booking in bookings %}


                                <tr>
                                    <td width="120px">{{ loop.index }}
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <div class="avatar-sm bg-light rounded p-1 me-2">
                                                <a class="image-popup"
                                                    href="{{url_for('static',filename='property_images/'+booking.property.images[0].picture_name)}}"
                                                    title="">

                                                    <img style="max-height: 40px;"
                                                        src="{{url_for('static',filename='property_images/'+booking.property.images[0].picture_name)}}"
                                                        alt="" class="avatar-sm rounded object-cover" />
                                                </a>
                                            </div>
                                            <h5 class="fs-14 my-1">
                                                <a href="{{url_for('admin_view.property_detail',property_id=booking.property.id)}}"
                                                    class="text-reset">{{booking.property.title}}</a>
                                            </h5>
                                        </div>
                                    </td>

                    </div>
                    </td>
                    <td>
                        <h5 class="fs-14 my-1 fw-normal">$ {{booking.total_charge}}</h5>
                    </td>
                    <td>
                        <h5 class="fs-14 my-1 fw-normal">
                            {{booking.start_date.strftime("%b %d ,%Y")}} to {{
                            booking.end_date.strftime("%b %d, %Y")}}</h5>

                    </td>
                    <td>
                        <h5 class="fs-14 my-1 fw-normal">{{booking.status}}</h5>
                    </td>

                    </tr>
                    {% endfor %}
                    <tr><td colspan="5" class="text-end"><a href=""  class="btn btn-dark">View all</a></td>   </tr>

                    {% endif %}
                    </tbody>

                    </table>
                </div>
            </div>
        </div>
    </div>
    <!-- end col -->
</div>




</div>

{% block javascript %}
<script src="https://cdn.lordicon.com/ritcuqlt.js"></script>
<script src="{{url_for('static',filename='assets/libs/prismjs/prism.js')}}"></script>
<script src="{{url_for('static',filename='assets/libs/list.js/list.min.js')}}"></script>
<script src="{{url_for('static',filename='assets/libs/list.pagination.js/list.pagination.min.js')}}"></script>
<script src="{{url_for('static',filename='assets/js/pages/listjs.init.js')}}"></script>
<script src="{{url_for('static',filename='assets/libs/sweetalert2/sweetalert2.min.js')}}"></script>

{% endblock javascript %}

{% endblock content %}